# Run the Playbooks
For installing disconnected clusters, you will mostly be following rhe same process as a standard connected cluster.

The main additional steps we would be doing is mirroring the OCP images to another registry which is accessible to
the cluster and post the cluster coming up, we will be applying operator hub manifests such as image content source
policy and catalog source, generated by `oc-mirror`, to the cluster.
## Pre-requisites
* A running registry where the OCP and operator hub images will be mirrored.
* A mirror host. This can be any host that can access the internet (mainly the registry being mirrored from) as well as the registry being mirrored to.
* `oc-mirror` binary in tar.gz format, present on the File server.
* Appropriately updated variables in your `all.yaml`. Refer the variables documentation.
### NOTE 
* The platorm related image content source policy will be baked into the install config as part of **5 Setup Bastion Playbook**. 
* Right now on legacy platform mirroring is supported in this playook during the creation of the cluster. 
* Manifests generated by `oc-mirror` will be applied to the cluster cluster up. So if you add platform details in image set, it
  will be applied on cluster only after the cluster is up.

## Disconnected Mirror Artifacts Playbook
### Overview
Mirror the ocp platform and other nessasary images to the mirror registry. Please run this playbook before you run **6 Create Nodes Playbook** and after
**0 Setup Playbook**.
### Outcomes
* Download `oc` and `oc-mirror` to the mirror host.
* Template the mirror pull secret to the mirror host.
* Add the ca cert to the mirror host anchors if ca is not trusted.
* Mirror the platform images using `oc adm release mirror` if legacy mirroring is enabled.
* Template the image set to mirror host and then mirror it using `oc-mirror` plogin.
* Copy the results on the `oc-mirror` to ansible controller to apply to cluster in future steps.
### Notes
* Currently, platform can **only** be mirrored the legacy way. While the image set can contain platform mirroring configs, it will **not** be applied to cluster during creation. 
* This playbook can be run at any stage after the **0 Setup** playbook. Make sure to run this before the cluster starts pulling at the images from the registry 
  which typically happens where the **Create Nodes Playbook** is run.

# Disconnected apply oc mirror manifests to cluster Playbook
### Overview
Post cluster creation, `oc-mirror` manifests are applied to the cluster. Please run this playbook after **7 OCP Verification Playbook**.
### Outcomes
* Copy the `oc-mirror` results manifests to the bastion.
* Apply the copied manifests to the cluster.
* Disable default content sources.
