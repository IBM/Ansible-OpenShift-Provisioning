---

- name: Get Red Hat CoreOS kernel and initramfs from URL to /var/lib/libvirt/images
  tags: prep_kvm_guests
  vars:
    version: "{{ env.openshift.version }}"
    arch: "{{ env.install_config.control.architecture }}"
    major: "{{ env.openshift.version | string | first }}"
  get_url:
    url: "{{ item.url }}"
    dest: "{{ item.dest }}"
    mode: '0755'
  loop:
    - { url: "https://mirror.openshift.com/pub/openshift-v{{ major }}/{{ arch }}/dependencies/rhcos/{{ version }}/latest/rhcos-live-kernel-{{ arch }}", dest: "/var/lib/libvirt/images/rhcos-live-kernel-{{ version }}-{{ arch }}" }
    - { url: "https://mirror.openshift.com/pub/openshift-v{{ version | string | first }}/{{ arch }}/dependencies/rhcos/{{ version }}/latest/rhcos-live-initramfs.{{ arch }}.img", dest: "/var/lib/libvirt/images/rhcos-live-initramfs-{{ version }}-{{ arch }}.img" }